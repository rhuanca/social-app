<!DOCTYPE html>
<html>
<head>
    <meta name="viewport" content="initial-scale=1.0, user-scalable=no"/>
    <style type="text/css">
        html {
            height: 100%
        }

        body {
            height: 100%;
            margin: 0;
            padding: 0
        }

        #map_canvas {
            height: 100%
        }
    </style>
    <script type="text/javascript"
            src="https://maps.googleapis.com/maps/api/js?sensor=true&language=es">
    </script>
    <script type="text/javascript">

        var fillColor = {
            '1':'LightYellow',
            '2':'Gold',
            '3':'LightSalmon',
            '4':'DarkOrange',
            '5':'Red'
        };

        var strokeColor = {
            '1':'Khaki',
            '2':'GoldenRod',
            '3':'Orange',
            '4':'OrangeRed',
            '5':'DarkRed'
        };

        var pointVillazon = {
            "latitude":-16.504772,
            "longitude":-68.13062,
            "name":"Villazon",
            "id":1,
            "zoneZoom":14,
            "zoneName":"Zona Central",
            "radius":500,
            "level":2,
            "tooltip":"Marcha de presupuesto para la U"
        };

        var unknown = {
            "latitude":-16.503507,
            "longitude":-68.16206,
            "name":"Villazon",
            "id":1,
            "zoneZoom":14,
            "zoneName":"Zona Central",
            "radius":50,
            "level":3,
            "tooltip":"Marcha de presupuesto para la U"
        };

        var pointPerez = {
            "latitude":-16.495164,
            "longitude":-68.136767,
            "name":"Perez",
            "id":1,
            "zoneZoom":14,
            "zoneName":"Zona Norte",
            "radius":500,
            "level":1,
            "tooltip":"Marcha de presupuesto para la U"
        };

        var pointCalle8 = {
            "latitude":-16.541312,
            "longitude":-68.091465,
            "name":"Perez",
            "id":1,
            "zoneZoom":14,
            "zoneName":"Zona Norte",
            "radius":500,
            "level":1,
            "tooltip":"Marcha de presupuesto para la U"
        };

        //var directionsDisplay;
        //var directionsService = new google.maps.DirectionsService();

        function getFillColor(level) {
            return fillColor[level];
        }

        function getStrokeColor(level) {
            return strokeColor[level];
        }

        function drawPoint(map, point) {
            var latLng = new google.maps.LatLng(point.latitude, point.longitude);
            var marker = new google.maps.Marker({
                position:latLng,
                map:map,
                title:point.name
            });
        }

        function drawConflictPoint(map, point) {
            var latLng = new google.maps.LatLng(point.latitude, point.longitude);
            var circle = new google.maps.Circle({radius:point.radius, center:latLng, fillColor:getFillColor(point.level), strokeColor:getStrokeColor(point.level)});
            circle.setCenter(latLng);
            circle.setMap(map);
            var marker = new google.maps.Marker({
                position:latLng,
                map:map,
                title:point.tooltip
            });
        }

        function traceRoute(div, conflictPoints, routePoint1, routePoint2) {
            var laPaz = new google.maps.LatLng(-16.509174, -68.136864);
            var mapOptions = {
                center:laPaz,
                zoom:12,
                mapTypeId:google.maps.MapTypeId.ROADMAP
            };
            var map = new google.maps.Map(div, mapOptions);
            if (!(typeof conflictPoints === 'undefined') && conflictPoints) {
                for (i = 0; i < conflictPoints.length; i++) {
                    drawConflictPoint(map, conflictPoints[i]);
                }
            }
            if (!(typeof routePoint1 === 'undefined') && routePoint1 && !(typeof routePoint2 === 'undefined') && routePoint2) {
                directionsDisplay = new google.maps.DirectionsRenderer();
                directionsDisplay.setMap(map);
                var latLng1 = new google.maps.LatLng(routePoint1.latitude, routePoint1.longitude);
                var latLng2 = new google.maps.LatLng(routePoint2.latitude, routePoint2.longitude);
                calcRoute(latLng1, latLng2, directionsDisplay);
            }
        }

        function tracePoints(div, routePoint1, routePoint2) {
            var laPaz = new google.maps.LatLng(-16.509174, -68.136864);
            var mapOptions = {
                center:laPaz,
                zoom:12,
                mapTypeId:google.maps.MapTypeId.ROADMAP
            };
            var map = new google.maps.Map(div, mapOptions);
            if ((!(typeof routePoint1 === 'undefined') && routePoint1) && ((typeof routePoint2 === 'undefined') || !routePoint2)) {
                drawPoint(map, routePoint1);
            }
            if (!(typeof routePoint1 === 'undefined') && routePoint1 && !(typeof routePoint2 === 'undefined') && routePoint2) {
                directionsDisplay = new google.maps.DirectionsRenderer();
                directionsDisplay.setMap(map);
                var latLng1 = new google.maps.LatLng(routePoint1.latitude, routePoint1.longitude);
                var latLng2 = new google.maps.LatLng(routePoint2.latitude, routePoint2.longitude);
                calcRoute(latLng1, latLng2, directionsDisplay);
            }
        }


        function calcRoute(start, end, directionsDisplay) {
            var request = {
                origin:start,
                destination:end,
                provideRouteAlternatives:true,
                travelMode:google.maps.TravelMode.DRIVING
            };
            var directionsService = new google.maps.DirectionsService();
            directionsService.route(request, function (result, status) {
                if (status == google.maps.DirectionsStatus.OK) {
                    directionsDisplay.setDirections(result);
                }
            });
        }

        function initialize() {
            traceRoute(document.getElementById("map_canvas"), [pointVillazon], pointPerez, pointCalle8);
            //tracePoints(document.getElementById("map_canvas"), pointPerez);
        }
    </script>
</head>
<body onload="initialize()">
<div id="map_canvas" style="float:left;width:70%; height:100%"></div>
<div id="directionsPanel" style="float:right;width:30%;height:100%"></div>
</body>
</html>