<!DOCTYPE html>
<html>
<head>
    <meta charset="utf-8">
    <title>Hackthon 2012</title>
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta name="description" content="">
    <meta name="author" content="">

    <!-- Templates -->
    <script id="treeTempl" type="text/x-jsrender">
        <dl>
            <dl style="text-align: center"><h2 class="text-error">{{>cityName}}</h2></dl>
            {{for zones}}
            <dt>
            <p class="text-error">{{>zoneName}}</p></dt>
            {{for points}}
            <!--<blockquote>-->
            <dd><a href="#" class="text-warning">{{>pointName}}</a></dd>
            <!--</blockquote>-->
            {{/for}}
            {{/for}}
        </dl>
    </script>

    <!-- Css -->
    <link href="css/bootstrap.min.css" rel="stylesheet" media="screen">
    <link href="css/hardcoders.css" rel="stylesheet" media="screen">

    <!-- Java scripts -->
    <script src="js/jquery.js"></script>
    <script src="js/jquery-ui.min.js"></script>
    <script src="js/bootstrap.min.js"></script>
    <script src="js/jsrender.js"></script>
    <script src="js/map.js"></script>
    <script type="text/javascript"
            src="https://maps.googleapis.com/maps/api/js?sensor=true&language=es">
    </script>
    <script type="text/javascript">

        var fillColor = {
            '1':'LightYellow',
            '2':'Gold',
            '3':'LightSalmon',
            '4':'DarkOrange',
            '5':'Red'
        };

        var strokeColor = {
            '1':'Khaki',
            '2':'GoldenRod',
            '3':'Orange',
            '4':'OrangeRed',
            '5':'DarkRed'
        };

        var pointVillazon = {
            "latitude":-16.504772,
            "longitude":-68.13062,
            "name":"Villazon",
            "id":1,
            "zoneZoom":14,
            "zoneName":"Zona Central",
            "radius":500,
            "level":2,
            "tooltip":"Marcha de presupuesto para la U"
        };

        var unknown = {
            "latitude":-16.503507,
            "longitude":-68.16206,
            "name":"Villazon",
            "id":1,
            "zoneZoom":14,
            "zoneName":"Zona Central",
            "radius":50,
            "level":3,
            "tooltip":"Marcha de presupuesto para la U"
        };

        var pointPerez = {
            "latitude":-16.495164,
            "longitude":-68.136767,
            "name":"Perez",
            "id":1,
            "zoneZoom":14,
            "zoneName":"Zona Norte",
            "radius":500,
            "level":1,
            "tooltip":"Marcha de presupuesto para la U"
        };

        var pointCalle8 = {
            "latitude":-16.541312,
            "longitude":-68.091465,
            "name":"Perez",
            "id":1,
            "zoneZoom":14,
            "zoneName":"Zona Norte",
            "radius":500,
            "level":1,
            "tooltip":"Marcha de presupuesto para la U"
        };

        //var directionsDisplay;
        //var directionsService = new google.maps.DirectionsService();

        function getFillColor(level) {
            return fillColor[level];
        }

        function getStrokeColor(level) {
            return strokeColor[level];
        }

        function drawPoint(map, point) {
            var latLng = new google.maps.LatLng(point.latitude, point.longitude);
            var marker = new google.maps.Marker({
                position:latLng,
                map:map,
                title:point.name
            });
        }

        function drawConflictPoint(map, point) {
            var latLng = new google.maps.LatLng(point.latitude, point.longitude);
            var circle = new google.maps.Circle({radius:point.radius, center:latLng, fillColor:getFillColor(point.level), strokeColor:getStrokeColor(point.level)});
            circle.setCenter(latLng);
            circle.setMap(map);
            var marker = new google.maps.Marker({
                position:latLng,
                map:map,
                title:point.tooltip
            });
        }

        function traceRoute(div, conflictPoints, routePoint1, routePoint2) {
            var laPaz = new google.maps.LatLng(-16.509174, -68.136864);
            var mapOptions = {
                center:laPaz,
                zoom:12,
                mapTypeId:google.maps.MapTypeId.ROADMAP
            };
            var map = new google.maps.Map(div, mapOptions);
            if (!(typeof conflictPoints === 'undefined') && conflictPoints) {
                for (i = 0; i < conflictPoints.length; i++) {
                    drawConflictPoint(map, conflictPoints[i]);
                }
            }
            if (!(typeof routePoint1 === 'undefined') && routePoint1 && !(typeof routePoint2 === 'undefined') && routePoint2) {
                directionsDisplay = new google.maps.DirectionsRenderer();
                directionsDisplay.setMap(map);
                var latLng1 = new google.maps.LatLng(routePoint1.latitude, routePoint1.longitude);
                var latLng2 = new google.maps.LatLng(routePoint2.latitude, routePoint2.longitude);
                calcRoute(latLng1, latLng2, directionsDisplay);
            }
        }

        function tracePoints(div, routePoint1, routePoint2) {
            var laPaz = new google.maps.LatLng(-16.509174, -68.136864);
            var mapOptions = {
                center:laPaz,
                zoom:12,
                mapTypeId:google.maps.MapTypeId.ROADMAP
            };
            var map = new google.maps.Map(div, mapOptions);
            if ((!(typeof routePoint1 === 'undefined') && routePoint1) && ((typeof routePoint2 === 'undefined') || !routePoint2)) {
                drawPoint(map, routePoint1);
            }
            if (!(typeof routePoint1 === 'undefined') && routePoint1 && !(typeof routePoint2 === 'undefined') && routePoint2) {
                directionsDisplay = new google.maps.DirectionsRenderer();
                directionsDisplay.setMap(map);
                var latLng1 = new google.maps.LatLng(routePoint1.latitude, routePoint1.longitude);
                var latLng2 = new google.maps.LatLng(routePoint2.latitude, routePoint2.longitude);
                calcRoute(latLng1, latLng2, directionsDisplay);
            }
        }


        function calcRoute(start, end, directionsDisplay) {
            var request = {
                origin:start,
                destination:end,
                provideRouteAlternatives:true,
                travelMode:google.maps.TravelMode.DRIVING
            };
            var directionsService = new google.maps.DirectionsService();
            directionsService.route(request, function (result, status) {
                if (status == google.maps.DirectionsStatus.OK) {
                    directionsDisplay.setDirections(result);
                }
            });
        }

        function initialize(divId) {
            traceRoute(document.getElementById(divId), [pointVillazon], pointPerez, pointCalle8);
            //tracePoints(document.getElementById("map_canvas"), pointPerez);
        }
    </script>

</head>
<body onload="initialize('map_canvas');">

<!--<div id="map_canvas" style="float:left;width:70%; height:100%"></div>-->
<!--<div id="directionsPanel" style="float:right;width:30%;height:100%"></div>-->

<!-- layout -->
<div id="wrap" class="container">

    <!-- Header -->
    <div class="page-header">
        <h1>
            Ch'enko<small>diario.org</small>
            <div class="control-group pull-right">
                <a href="#reportConflictButtonId" role="button" class="btn btn-warning" data-toggle="modal">Reportar un
                    Conflicto</a>
                <a id="signupButton" href="#" role="button" class="btn" data-toggle="modal">Registrate</a>
            </div>
        </h1>
    </div>

    <!-- nav bar -->
    <div class="navbar navbar-inverse">
        <div class="navbar-inner">
            <!-- <a class="brand" href="#">Title</a> -->
            <ul class="nav">
                <li class="active"><a href="#">Mapa de Conflictos</a></li>
                <li><a href="#">Alerta de conflictos</a></li>
            </ul>
        </div>
    </div>

    <div class="container-fluid">
        <div class="row-fluid">
            <div class="span4">
                <div>
                    <h5 class="text-info">Bloqueos de hoy :
                        <span id="conflictDate" class="inline">
                            <!---->
                        </span>
                    </h5>

                </div>
                <!--Sidebar content-->
                <div class="sidebar-nav" id="tree">
                    <!-- dinamically populated -->
                </div>
                <!--<div class="sidebar-nav" id="conflictReportId">-->
                <!--<p><input type="text" id="datepicker"/></p>-->
                <!--</div>-->
            </div>
            <div class="span8">
                <div id="map_canvas" style="float:left;width:600px; height:450px">
                    <!---->
                </div>

                <!--Body content-->
                <!--<iframe width="525" height="450" frameborder="0" scrolling="no" marginheight="0"-->
                        <!--marginwidth="0" webkitAllowFullScreen mozAllowFullScreen allowFullScreen-->
                        <!--src="http://maps.google.es/?t=m&amp;ie=UTF8&amp;ll=-16.509174,-68.136864&amp;spn=0.188943,0.338173&amp;z=12&amp;output=embed"></iframe>-->
                <!--<br/>-->
                <!--<small>-->
                    <!--<a href="http://maps.google.es/?t=m&amp;ie=UTF8&amp;ll=-16.509174,-68.136864&amp;spn=0.188943,0.338173&amp;z=12&amp;source=embed"-->
                       <!--style="color:#0000FF;text-align:left">Agrandar</a>-->
                <!--</small>-->

            </div>
            <div class="pull-right">
            	<a href="#" role="button" class="btn" data-toggle="modal">Embeber Mapa</a>
            </div>
        </div>
    </div>
</div>
<footer class="footer" style="background-color:#c2c2c2;">
    <img alt="" src="img/dal2012-banner-01.png" style="height: 40px;">
    <img alt="" style="height: 40px;" src="img/unirbolivia-banner.jpg">
</footer>

<!--
    --
    -- Secundary views
    --
    -->

<!-- sign up modal -->
<div class="modal hide fade in" id="signup-modal" style="display: none">
    <a class="close" data-dismiss="modal">×</a>

    <h1>Ingrese con su cuenta</h1>

    <form action="/signup" method="POST" autocomplete="off">
        <div style="display:none"><input type="hidden" name="csrfmiddlewaretoken"
                                         value="sE5xDFuLtWGNuJS9mQrAXV6rWPPFia9w"></div>
        <small class="pull-right"><a href="/login/"><span>Si no tiene una cuenta entonces </span>Registrarse</a>
        </small>
        <fieldset>
            <input type="hidden" name="next" value="/welcome/">

            <input type="email" placeholder="Email" name="email" maxlength="75" id="id_email">

            <div class="email_suggestion"></div>
            <input type="password" placeholder="Contraseña" name="password" id="id_password">
            <input type="submit" value="Ingresar" class="btn">
        </fieldset>
    </form>
    <form class="connect-button" name="login" method="post" action="/social/twitter/redirect/"
          id="twitter-connect-form">
        <div style="display:none"><input type="hidden" name="csrfmiddlewaretoken"
                                         value="sE5xDFuLtWGNuJS9mQrAXV6rWPPFia9w"></div>

        <input type="hidden" name="next" value="/welcome/">

        <a href="#" onclick="$('#twitter-connect-form').submit(); return false;" class="signup-twitter signup-btn"
           id="twitter_button"><i></i>Ingresar con Twitter</a>
    </form>

    <form class="connect-button" name="login" method="post" action="/social/facebook/redirect/"
          id="facebook-connect-form">
        <div style="display:none"><input type="hidden" name="csrfmiddlewaretoken"
                                         value="sE5xDFuLtWGNuJS9mQrAXV6rWPPFia9w"></div>

        <input type="hidden" name="next" value="/welcome/">

        <a href="#" onclick="$('#facebook-connect-form').submit(); return false;" class="signup-facebook signup-btn"
           id="facebook_button"><i></i>Ingresar con Facebook</a>
    </form>
</div>

<!-- report a conflict -->

<div id="reportConflictButtonId" class="modal hide fade" tabindex="-1" role="dialog"
     aria-labelledby="myModalLabel" aria-hidden="true">
    <form class="form-inline">
        <div class="modal-header">
            <!--<button type="button" class="close" data-dismiss="modal" aria-hidden="true">×</button>-->
            <h3 id="myModalLabel">Reportar Conflicto</h3>
        </div>
        <div class="modal-body">
            <label class="radio span3">
                <input type="radio" name="conflictPoint" id="conflictPoint" value="point"
                       checked>
                Llenar Punto del Bloqueo
            </label>
            <label class="radio span3">
                <input type="radio" name="conflictPoint" id="conflictPath" value="path">
                Llenar Ruta del Bloqueo
            </label>
            <br/>
            <br/>

            <div id="detectPoint">
                <label class="span3 control-label">Lugar de bloqueo</label>
                <select id="select2" class="chooseManualSelection span3" name="conflictPoint">
                </select>

                <br/>
                <br/>

                <label class="span3 control-label">Detalle del bloqueo</label>
                <textarea rows="5" cols="10" id="detailConflict" class="span3"></textarea>
            </div>

            <div id="detectPath" style="display: none">
                <label for="selectReportSource" class="span3 control-label">Origen</label>
                <select id="selectReportSource" class="chooseManualSelection span3"
                        name="conflictPoint">
                </select>

                <br/>
                <br/>

                <label for="selectReportDestiny" class="span3 control-label">Destino</label>
                <select id="selectReportDestiny" class="chooseManualSelection span3"
                        name="conflictPoint">
                </select>

                <br/>
                <br/>

                <label class="span3 control-label">Detalle del bloqueo</label>
                <textarea rows="5" cols="10" id="detailConflictPath" class="span3"></textarea>
            </div>
            <br/>

            <div class="span8">
                <div id="mapReportConflict" style="float:left;width:500px; height:350px"></div>

                <!--Body content-->
                <!--<iframe width="525" height="450" frameborder="0" scrolling="no" marginheight="0"-->
                <!--marginwidth="0" webkitAllowFullScreen mozAllowFullScreen allowFullScreen-->
                <!--src="http://maps.google.es/?t=m&amp;ie=UTF8&amp;ll=-16.509174,-68.136864&amp;spn=0.188943,0.338173&amp;z=12&amp;output=embed"></iframe>-->
                <!--<br/>-->
                <!--<small>-->
                <!--<a href="http://maps.google.es/?t=m&amp;ie=UTF8&amp;ll=-16.509174,-68.136864&amp;spn=0.188943,0.338173&amp;z=12&amp;source=embed"-->
                <!--style="color:#0000FF;text-align:left">Agrandar</a>-->
                <!--</small>-->

            </div>


        </div>
    </form>
    <div class="modal-footer">
        <button class="btn" data-dismiss="modal" aria-hidden="true">Close</button>
        <button class="btn btn-primary" id="saveReportConflict">Save changes</button>
    </div>
</div>
</body>
</html>
